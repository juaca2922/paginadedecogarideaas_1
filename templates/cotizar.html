{% extends 'base.html' %}

{% block title %}Cotizar - Decogarideas{% endblock %}

{% block content %}
<h1 style="font-size: 3rem; text-align: center;">¡Cotiza tu Producto!</h1>

<!-- Selección de producto -->
<div class="form-group">
    <label for="producto" class="h4" style="font-size: 3.75rem;">Producto</label>
    <select class="form-control form-control-lg" id="producto" name="producto" onchange="mostrarOpciones()" required>
        <option value="">Selecciona un producto</option>
        <option value="macetas">Maceta</option>
        <option value="macetas_de_loza">Maceta de loza</option>
        <option value="macetas_de_arcilla">Maceta de arcilla</option>
        <option value="velas">Vela</option>
        <option value="velas_tubo">Vela tubo</option>
    </select>
</div>

<!-- Contenedor donde se carga dinámicamente el contenido del producto -->
<div id="producto-seleccionado" class="mt-4" aria-live="polite"></div>

<script>
    function mostrarOpciones() {
        const productoSeleccionado = document.getElementById('producto').value;
        const contenedor = document.getElementById('producto-seleccionado');

        console.log("Producto seleccionado:", productoSeleccionado); // Depuración

        if (!productoSeleccionado) {
            contenedor.innerHTML = '';
            return;
        }

        contenedor.innerHTML = '<p>Cargando opciones...</p>';

        fetch(`/cotizar_producto_seleccionado/${productoSeleccionado}`)
            .then(response => {
                if (!response.ok) throw new Error(`Error ${response.status}`);
                return response.text();
            })
            .then(data => {
                contenedor.innerHTML = data;
            })
            .catch(error => {
                console.error('Error al cargar el contenido:', error);
                contenedor.innerHTML = '<p>Error al cargar las opciones del producto. Por favor, intenta nuevamente.</p>';
            });
    }
</script>
{% endblock %}
